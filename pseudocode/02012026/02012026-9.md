9. Triple EMA Trend-Rider (TEMA 9/21/55)
   Concept: Use three EMAs to define trend and momentum; enter on pullback to middle EMA while all EMAs aligned.

Indicators:

EMA 9, EMA 21, EMA 55

timeframe = "5m"

populate_indicators(dataframe):
dataframe.ema9 = EMA(close, 9)
dataframe.ema21 = EMA(close, 21)
dataframe.ema55 = EMA(close, 55)
return dataframe

populate_entry_trend(dataframe):

    # LONG: strong uptrend alignment and pullback to EMA21
    buy_signal = (
        (ema9 > ema21) AND (ema21 > ema55)
        AND (low <= ema21) AND (close > ema21)              # test of ema21
    )

    # SHORT: strong downtrend alignment and pullback to EMA21
    sell_signal = (
        (ema9 < ema21) AND (ema21 < ema55)
        AND (high >= ema21) AND (close < ema21)
    )

    dataframe.enter_long = buy_signal
    dataframe.enter_short = sell_signal
    return dataframe

populate_exit_trend(dataframe):

    exit_long = (
        (close < ema9) OR
        (percentage_profit >= 1.5%)
    )
    exit_short = (
        (close > ema9) OR
        (percentage_profit >= 1.5%)
    )

    dataframe.exit_long = exit_long
    dataframe.exit_short = exit_short
    return dataframe
